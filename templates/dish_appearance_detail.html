{% extends 'base.html' %}
{% load crispy_forms_tags %}

{% block content %}
    <h1>{{ dish_appearance.dish.name }}</h1>
    <h2>
        <img src="https://external-content.duckduckgo.com/iu/?u=http%3A%2F%2Fpurepng.com%2Fpublic%2Fuploads%2Flarge%2Fpurepng.com-gold-starstargeometricallydecagonconcavestardomyellow-stargold-1421526501440ojzfo.png&f=1&nofb=1"
             alt="Star" class="star">
        Dish Appearance: {{ dish_appearance.average_stars }}/5 <span
            class="text-muted">{{ dish_appearance.review_count }} reviews</span>
    </h2>
    <h2>
        <img src="https://external-content.duckduckgo.com/iu/?u=http%3A%2F%2Fpurepng.com%2Fpublic%2Fuploads%2Flarge%2Fpurepng.com-gold-starstargeometricallydecagonconcavestardomyellow-stargold-1421526501440ojzfo.png&f=1&nofb=1"
             alt="Star" class="star">
        {% with overall_dish=dish_appearance.overall_rating_count_average %}
            Overall Dish: {{ overall_dish.average }}/5 <span
                class="text-muted">{{ overall_dish.count }} reviews</span>
        {% endwith %}
    </h2>
    <div class="rounded shadow-sm p-4">
        <h5 class="mb-1">All Ratings and Reviews</h5>
        {% for review in dish_appearance.reviews %}
            <div class="reviews-members pt-3 pb-2">
                <div class="media">
                    <div class="media-body">
                        <div class="reviews-members-header">
                            <h4 class="mb-1"><a href="#">{{ review.user.username }}</a></h4>
                            <h6>{{ review.stars }} Stars</h6>
                            <p class="text-gray">{{ review.review_datetime }}</p>
                        </div>
                        <div class="reviews-members-body">
                            <p>{{ review.review_text }}</p>
                        </div>
                    </div>
                </div>
            </div>
            <hr>
        {% endfor %}
    </div>
    <div class="rounded shadow-sm p-4 mb-2">
        <h5 class="mb-2">Leave Review for {{ dish_appearance.dish.name }}</h5>
        <form method="POST" action="{% url 'review' %}?dish={{ dish_appearance.uuid }}">
            {% csrf_token %}
            <fieldset class="form-group">
                {{ review_form|crispy }}
            </fieldset>
            <div class="form-group">
                <button class="btn btn-primary btn-sm" type="submit"> Submit Review</button>
            </div>
        </form>
    </div>
{% endblock %}